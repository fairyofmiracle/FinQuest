{% extends 'base.html' %}
{% block title %}FinQuest ‚Äî –ì–ª–∞–≤–Ω–∞—è{% endblock %}
{% block page_title %}<i class="fa-solid fa-money-bill-trend-up me-2"></i>FinQuest{% endblock %}

{% block content %}
{% if is_first_visit %}
<div id="first-visit-trigger" style="display: none;"></div>
{% endif %}

<!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
<div class="welcome-section mb-4 fade-in">
  <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è - –±–æ–ª—å—à–æ–π –±–∞–Ω–Ω–µ—Ä -->
  <div class="mobile-welcome-banner">
    <div class="mobile-welcome-content">
      <div class="mobile-welcome-avatar">
        {% if user.get_avatar_display %}
          <img src="{{ user.get_avatar_display }}" class="shadow {{ user.get_avatar_border_class }}" alt="–ê–≤–∞—Ç–∞—Ä">
        {% else %}
          <div class="mobile-avatar-placeholder {{ user.get_avatar_border_class }}">
            {{ user.username|first|upper }}
          </div>
        {% endif %}
      </div>
      <div class="mobile-welcome-text">
        <h2 class="mobile-welcome-title">–ü—Ä–∏–≤–µ—Ç, {{ user.username }}! üëã</h2>
        <p class="mobile-welcome-subtitle">{{ user.get_level_title }} ‚Ä¢ –£—Ä–æ–≤–µ–Ω—å {{ user.level_number }}</p>
      </div>
    </div>
  </div>
  
  <!-- –î–µ—Å–∫—Ç–æ–ø–Ω–∞—è –≤–µ—Ä—Å–∏—è -->
  <div class="desktop-welcome-content">
    <div class="row align-items-center">
      <div class="col-auto">
        {% if user.get_avatar_display %}
          <img src="{{ user.get_avatar_display }}" class="shadow {{ user.get_avatar_border_class }}" width="60" height="60" alt="–ê–≤–∞—Ç–∞—Ä" style="border-radius: 50%; object-fit: cover;">
        {% else %}
          <div class="bg-primary text-white d-flex align-items-center justify-content-center shadow {{ user.get_avatar_border_class }}"
               style="width:60px; height:60px; font-size:24px; font-weight:bold; border-radius: 50%;">
            {{ user.username|first|upper }}
          </div>
        {% endif %}
      </div>
      <div class="col">
        <h4 class="mb-0">, {{ user.username }}! üëã</h4>
        <p class="text-muted mb-0 small">{{ user.get_level_title }} ‚Ä¢ –£—Ä–æ–≤–µ–Ω—å {{ user.level_number }}</p>
      </div>
    </div>
  </div>
</div>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
<div class="stats-grid mb-4 slide-in-left">
  <div class="stat-card haptic-light">
    <div class="stat-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
      üéØ
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ user.points }}</div>
      <div class="stat-label">–û—á–∫–∏</div>
    </div>
  </div>
  
  <div class="stat-card haptic-light">
    <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
      ü™ô
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ user.coins }}</div>
      <div class="stat-label">–ú–æ–Ω–µ—Ç—ã</div>
    </div>
  </div>
  
  <div class="stat-card haptic-light">
    <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
      üî•
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ user.streak_days }}</div>
      <div class="stat-label">–°–µ—Ä–∏—è</div>
    </div>
  </div>
  
  <div class="stat-card haptic-light">
    <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
      ‚≠ê
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ user.get_level_number }}</div>
      <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
    </div>
  </div>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div class="quick-actions mb-4 slide-in-right">
  <h5 class="section-title mb-3"><i class="fa-solid fa-bolt"></i> –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h5>
  <div class="quick-actions-grid">
    <a href="{% url 'daily_quests' %}" class="quick-action-btn haptic-medium">
      <i class="fa-solid fa-calendar-day"></i>
      <span>–ó–∞–¥–∞–Ω–∏—è</span>
    </a>
    <a href="{% url 'leaderboard' %}" class="quick-action-btn haptic-medium">
      <i class="fa-solid fa-ranking-star"></i>
      <span>–†–µ–π—Ç–∏–Ω–≥</span>
    </a>
    <a href="{% url 'mobile_achievements' %}" class="quick-action-btn haptic-medium">
      <i class="fa-solid fa-award"></i>
      <span>–ù–∞–≥—Ä–∞–¥—ã</span>
    </a>
    <a href="{% url 'settings' %}" class="quick-action-btn haptic-medium">
      <i class="fa-solid fa-cog"></i>
      <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
    </a>
  </div>
</div>

<!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è -->
<div class="progress-section mb-4 fade-in">
  <a href="{% url 'mobile_skills' %}" class="card progress-card-link haptic-light" style="text-decoration: none; color: inherit;">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h6 class="mb-0"><i class="fa-solid fa-chart-line me-2"></i>–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å</h6>
        <div>
          <span class="badge bg-primary">{{ overall_progress }}%</span>
          <i class="fa-solid fa-chevron-right ms-2 text-muted" style="font-size: 0.9rem;"></i>
        </div>
      </div>
      <div class="progress" style="height: 10px;">
        <div class="progress-bar bg-gradient" role="progressbar" style="width: {{ overall_progress }}%;"></div>
      </div>
      <p class="text-muted small mt-2 mb-0">–ü—Ä–æ–π–¥–µ–Ω–æ {{ completed_levels }} –∏–∑ {{ total_levels }} —É—Ä–æ–≤–Ω–µ–π</p>
    </div>
  </a>
</div>

<!-- –û –ø—Ä–æ–µ–∫—Ç–µ -->
<div class="about-section mb-4 fade-in">
  <div class="card">
    <div class="card-body">
      <h6 class="mb-2"><i class="fa-solid fa-lightbulb me-2"></i>–û FinQuest</h6>
      <p class="text-muted small mb-2">
        <strong>FinQuest</strong> ‚Äî —ç—Ç–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏ –≤ –∏–≥—Ä–æ–≤–æ–π —Ñ–æ—Ä–º–µ. 
        –ú—ã –¥–µ–ª–∞–µ–º —Å–ª–æ–∂–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç–µ–º—ã –ø—Ä–æ—Å—Ç—ã–º–∏ –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–º–∏!
      </p>
      <p class="text-muted small mb-0">
        üéØ –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—á–∫–∏ ‚Ä¢ üèÜ –ü–æ–ª—É—á–∞–π—Ç–µ –Ω–∞–≥—Ä–∞–¥—ã ‚Ä¢ üìö –£—á–∏—Ç–µ—Å—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ
      </p>
    </div>
  </div>
</div>

<!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
{% if recent_achievements %}
<div class="recent-achievements mb-4 slide-in-left">
  <h5 class="section-title mb-3"><i class="fa-solid fa-trophy"></i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã</h5>
  <div class="achievements-scroll">
    {% for user_achievement in recent_achievements %}
    <div class="achievement-mini haptic-light">
      <img src="/static/images/achievements/{{ user_achievement.achievement.name|lower|cut:' '|cut:','}}.svg" 
           alt="{{ user_achievement.achievement.name }}" 
           style="width: 50px; height: 50px;"
           onerror="this.onerror=null; this.src='/static/images/achievements/trophy.svg';">
      <div class="achievement-mini-info">
        <div class="achievement-mini-name">{{ user_achievement.achievement.name }}</div>
        <div class="achievement-mini-date">{{ user_achievement.earned_at|date:"d.m.Y" }}</div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

<!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ -->
<div class="mobile-categories-section">
  <h3 class="mobile-section-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è</h3>
  <div class="mobile-categories-grid">
    <!-- –û—Å–Ω–æ–≤—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤ -->
    <a href="{% url 'category_detail' 'basics' %}" class="mobile-category-card haptic-medium">
      <div class="mobile-category-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <i class="fa-solid fa-piggy-bank"></i>
      </div>
      <div class="mobile-category-content">
        <h4 class="mobile-category-title">{{ categories.basics.name }}</h4>
        <p class="mobile-category-description">–ò–∑—É—á–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ–Ω—å–≥–∞–º–∏</p>
        <div class="mobile-category-progress">
          <div class="mobile-category-progress-bar">
            <div class="mobile-category-progress-fill" style="width: {{ categories.basics.progress_percent }}%;"></div>
          </div>
          <span class="mobile-category-progress-text">{{ categories.basics.progress_percent }}%</span>
        </div>
      </div>
      <div class="mobile-category-arrow">
        <i class="fa-solid fa-chevron-right"></i>
      </div>
    </a>

    <!-- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å -->
    <a href="{% url 'category_detail' 'security' %}" class="mobile-category-card haptic-medium">
      <div class="mobile-category-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
        <i class="fa-solid fa-shield-halved"></i>
      </div>
      <div class="mobile-category-content">
        <h4 class="mobile-category-title">{{ categories.security.name }}</h4>
        <p class="mobile-category-description">–ó–∞—â–∏—Ç–∏—Ç–µ —Å–µ–±—è –æ—Ç –º–æ—à–µ–Ω–Ω–∏–∫–æ–≤ –∏ —Ä–∏—Å–∫–æ–≤</p>
        <div class="mobile-category-progress">
          <div class="mobile-category-progress-bar">
            <div class="mobile-category-progress-fill" style="width: {{ categories.security.progress_percent }}%;"></div>
          </div>
          <span class="mobile-category-progress-text">{{ categories.security.progress_percent }}%</span>
        </div>
      </div>
      <div class="mobile-category-arrow">
        <i class="fa-solid fa-chevron-right"></i>
      </div>
    </a>

    <!-- –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ -->
    <a href="{% url 'category_detail' 'investments' %}" class="mobile-category-card haptic-medium">
      <div class="mobile-category-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
        <i class="fa-solid fa-chart-line"></i>
      </div>
      <div class="mobile-category-content">
        <h4 class="mobile-category-title">{{ categories.investments.name }}</h4>
        <p class="mobile-category-description">–ù–∞—É—á–∏—Ç–µ—Å—å –ø—Ä–∏—É–º–Ω–æ–∂–∞—Ç—å —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è</p>
        <div class="mobile-category-progress">
          <div class="mobile-category-progress-bar">
            <div class="mobile-category-progress-fill" style="width: {{ categories.investments.progress_percent }}%;"></div>
          </div>
          <span class="mobile-category-progress-text">{{ categories.investments.progress_percent }}%</span>
        </div>
      </div>
      <div class="mobile-category-arrow">
        <i class="fa-solid fa-chevron-right"></i>
      </div>
    </a>

    <!-- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ -->
    <a href="{% url 'category_detail' 'planning' %}" class="mobile-category-card haptic-medium">
      <div class="mobile-category-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
        <i class="fa-solid fa-bullseye"></i>
      </div>
      <div class="mobile-category-content">
        <h4 class="mobile-category-title">{{ categories.planning.name }}</h4>
        <p class="mobile-category-description">–î–æ—Å—Ç–∏–≥–∞–π—Ç–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ü–µ–ª–µ–π</p>
        <div class="mobile-category-progress">
          <div class="mobile-category-progress-bar">
            <div class="mobile-category-progress-fill" style="width: {{ categories.planning.progress_percent }}%;"></div>
          </div>
          <span class="mobile-category-progress-text">{{ categories.planning.progress_percent }}%</span>
        </div>
      </div>
      <div class="mobile-category-arrow">
        <i class="fa-solid fa-chevron-right"></i>
      </div>
    </a>
  </div>
</div>

<!-- –û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è (—Å–∫—Ä—ã–≤–∞–µ–º –≤ –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏) -->
<div class="categories-section-desktop">
<h5 class="mb-3 section-title"><i class="fa-solid fa-graduation-cap"></i> –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è</h5>

<div class="categories-grid mb-5">
  <!-- –û—Å–Ω–æ–≤—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤ -->
  <div class="main-category-card haptic-medium slide-in-up" onclick="location.href='{% url 'category_detail' 'basics' %}'">
    <div class="main-category-icon">
      <i class="fa-solid fa-piggy-bank"></i>
    </div>
    <h3 class="main-category-title">{{ categories.basics.name }}</h3>
    <p class="main-category-description">–ò–∑—É—á–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ–Ω—å–≥–∞–º–∏</p>
    <div class="main-category-stats">
      <div class="main-category-progress">
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: {{ categories.basics.progress_percent }}%;"></div>
        </div>
      </div>
      <div class="main-category-percent">{{ categories.basics.progress_percent }}%</div>
    </div>
    <button class="main-category-button">
      <i class="fa-solid fa-play me-2"></i>–ù–∞—á–∞—Ç—å
    </button>
  </div>

  <!-- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å -->
  <div class="main-category-card haptic-medium slide-in-up" onclick="location.href='{% url 'category_detail' 'security' %}'">
    <div class="main-category-icon">
      <i class="fa-solid fa-shield-halved"></i>
    </div>
    <h3 class="main-category-title">{{ categories.security.name }}</h3>
    <p class="main-category-description">–ó–∞—â–∏—Ç–∏—Ç–µ —Å–µ–±—è –æ—Ç –º–æ—à–µ–Ω–Ω–∏–∫–æ–≤ –∏ —Ä–∏—Å–∫–æ–≤</p>
    <div class="main-category-stats">
      <div class="main-category-progress">
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: {{ categories.security.progress_percent }}%;"></div>
        </div>
      </div>
      <div class="main-category-percent">{{ categories.security.progress_percent }}%</div>
    </div>
    <button class="main-category-button">
      <i class="fa-solid fa-shield me-2"></i>–ó–∞—â–∏—Ç–∏—Ç—å—Å—è
    </button>
  </div>

  <!-- –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ -->
  <div class="main-category-card haptic-medium slide-in-up" onclick="location.href='{% url 'category_detail' 'investments' %}'">
    <div class="main-category-icon">
      <i class="fa-solid fa-chart-line"></i>
    </div>
    <h3 class="main-category-title">{{ categories.investments.name }}</h3>
    <p class="main-category-description">–ù–∞—É—á–∏—Ç–µ—Å—å –ø—Ä–∏—É–º–Ω–æ–∂–∞—Ç—å —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è</p>
    <div class="main-category-stats">
      <div class="main-category-progress">
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: {{ categories.investments.progress_percent }}%;"></div>
        </div>
      </div>
      <div class="main-category-percent">{{ categories.investments.progress_percent }}%</div>
    </div>
    <button class="main-category-button">
      <i class="fa-solid fa-chart-line me-2"></i>–ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
    </button>
  </div>

  <!-- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ -->
  <div class="main-category-card haptic-medium slide-in-up" onclick="location.href='{% url 'category_detail' 'planning' %}'">
    <div class="main-category-icon">
      <i class="fa-solid fa-bullseye"></i>
    </div>
    <h3 class="main-category-title">{{ categories.planning.name }}</h3>
    <p class="main-category-description">–î–æ—Å—Ç–∏–≥–∞–π—Ç–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ü–µ–ª–µ–π</p>
    <div class="main-category-stats">
      <div class="main-category-progress">
        <div class="progress">
          <div class="progress-bar" role="progressbar" style="width: {{ categories.planning.progress_percent }}%;"></div>
        </div>
      </div>
      <div class="main-category-percent">{{ categories.planning.progress_percent }}%</div>
    </div>
    <button class="main-category-button">
      <i class="fa-solid fa-bullseye me-2"></i>–ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å
    </button>
  </div>
</div>
</div>

<style>
/* –°–∫—Ä—ã–≤–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
body.mobile-view .categories-section-desktop {
  display: none;
}

/* –°–∫—Ä—ã–≤–∞–µ–º –¥–µ—Å–∫—Ç–æ–ø–Ω—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
body.mobile-view .desktop-welcome-content {
  display: none !important;
}

/* –°–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ */
body:not(.mobile-view) .mobile-welcome-banner,
body:not(.mobile-view) .mobile-categories-section {
  display: none !important;
}

/* –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –¥–∞—à–±–æ—Ä–¥–∞ */
body:not(.mobile-view) .btn-mobile-view,
body:not(.mobile-view) a[href*='toggle_mobile_view'] {
  display: none !important;
}

/* –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ */
.welcome-section {
  background: white;
  padding: 1rem;
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
}

.welcome-section h4 {
  color: #1f2937 !important;
}

.welcome-section p {
  color: #6b7280 !important;
}

body.mobile-view .welcome-section {
  margin-bottom: 1rem;
}

/* –°–µ—Ç–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.75rem;
}

.stat-card {
  background: white;
  border-radius: 16px;
  padding: 1rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.2s ease;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.stat-card:active {
  transform: scale(0.95);
}

.stat-icon {
  width: 48px;
  height: 48px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  flex-shrink: 0;
}

.stat-content {
  flex: 1;
  min-width: 0;
}

.stat-value {
  font-size: 1.5rem;
  font-weight: 800;
  color: #1f2937;
  line-height: 1;
}

.stat-label {
  font-size: 0.75rem;
  color: #6b7280;
  margin-top: 0.25rem;
}

/* –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è */
.quick-actions-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0.75rem;
}

.quick-action-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 1rem 0.5rem;
  background: white;
  border-radius: 16px;
  text-decoration: none;
  color: #667eea;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  border: 1px solid rgba(0, 0, 0, 0.05);
  min-height: 80px;
}

.quick-action-btn:hover,
.quick-action-btn:focus {
  text-decoration: none;
  color: #667eea;
}

.quick-action-btn:active {
  transform: scale(0.95);
}

.quick-action-btn i {
  font-size: 1.5rem;
  margin-bottom: 0.5rem;
}

.quick-action-btn span {
  font-size: 0.75rem;
  font-weight: 600;
  text-align: center;
}

/* –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è */
.achievements-scroll {
  display: flex;
  gap: 0.75rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
  scrollbar-width: thin;
  -webkit-overflow-scrolling: touch;
}

.achievements-scroll::-webkit-scrollbar {
  height: 4px;
}

.achievements-scroll::-webkit-scrollbar-thumb {
  background: #667eea;
  border-radius: 4px;
}

.achievement-mini {
  flex-shrink: 0;
  background: white;
  border-radius: 12px;
  padding: 0.75rem;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  min-width: 200px;
  border: 1px solid rgba(0, 0, 0, 0.05);
}

.achievement-mini-info {
  flex: 1;
}

.achievement-mini-name {
  font-size: 0.85rem;
  font-weight: 700;
  margin-bottom: 0.25rem;
}

.achievement-mini-date {
  font-size: 0.7rem;
  color: #6b7280;
}

/* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */
.categories-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1rem;
}

/* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
body.dark-theme .welcome-section {
  background: #1e293b;
  border: 1px solid #475569;
}

body.dark-theme .welcome-section h4 {
  color: #f1f5f9;
}

body.dark-theme .welcome-section p {
  color: #9ca3af;
}

body.dark-theme .stat-card,
body.dark-theme .quick-action-btn,
body.dark-theme .achievement-mini {
  background: linear-gradient(135deg, rgba(30, 41, 59, 0.98) 0%, rgba(51, 65, 85, 0.92) 100%);
  border-color: #475569;
}

body.dark-theme .stat-value {
  color: #f1f5f9;
}

body.dark-theme .achievement-mini-name {
  color: #f1f5f9;
}

body.dark-theme .quick-action-btn {
  color: #a5b4fc;
}

body.dark-theme .quick-action-btn:hover,
body.dark-theme .quick-action-btn:focus {
  color: #a5b4fc;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ */
.slide-in-up {
  animation: slideInUp 0.5s ease;
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ */
@media (max-width: 768px) {
  /* –£–±–∏—Ä–∞–µ–º –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
  body.mobile-view .quick-actions {
    display: none !important;
  }
  
  /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–ª–æ–∫ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
  body.mobile-view .welcome-section {
    padding: 0.75rem !important;
  }
  
  body.mobile-view .welcome-section .col-auto img,
  body.mobile-view .welcome-section .col-auto > div {
    width: 50px !important;
    height: 50px !important;
    font-size: 20px !important;
  }
  
  body.mobile-view .welcome-section h4 {
    font-size: 1.1rem !important;
    margin-bottom: 0.25rem !important;
  }
  
  body.mobile-view .welcome-section p {
    font-size: 0.75rem !important;
  }
  
  body.mobile-view .stats-grid {
    gap: 0.75rem;
  }
  
  body.mobile-view .stat-card {
    padding: 0.75rem;
  }
  
  body.mobile-view .stat-icon {
    width: 48px !important;
    height: 48px !important;
    font-size: 1.5rem !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 12px !important;
  }
  
  body.mobile-view .stat-content {
    flex: 1 !important;
    min-width: 0 !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
  }
  
  body.mobile-view .stat-value {
    font-size: 1.4rem !important;
    font-weight: 800 !important;
    line-height: 1 !important;
    margin-bottom: 0.25rem !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  body.mobile-view .stat-label {
    font-size: 0.75rem !important;
    font-weight: 600 !important;
    margin-top: 0.25rem !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  /* –ë–ª–æ–∫ –æ –ø—Ä–æ–µ–∫—Ç–µ */
  body.mobile-view .about-section .card-body {
    padding: 1rem !important;
  }
  
  body.mobile-view .about-section h6 {
    font-size: 0.95rem !important;
  }
  
  body.mobile-view .about-section p {
    font-size: 0.8rem !important;
    line-height: 1.4 !important;
  }
  
  /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ */
  body.mobile-view h4, 
  body.mobile-view h5,
  body.mobile-view h6,
  body.mobile-view .section-title {
    color: #1f2937;
  }
  
  body.mobile-view.dark-theme h4,
  body.mobile-view.dark-theme h5,
  body.mobile-view.dark-theme h6,
  body.mobile-view.dark-theme .section-title {
    color: #f1f5f9;
  }
}

/* –†–µ–∑–µ—Ä–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö (–µ—Å–ª–∏ body.mobile-view –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç) */
@media (max-width: 768px) {
  .stat-icon {
    width: 48px !important;
    height: 48px !important;
    font-size: 1.5rem !important;
  }
  
  .stat-content {
    display: flex !important;
    flex-direction: column !important;
  }
  
  .stat-value {
    font-size: 1.4rem !important;
    font-weight: 800 !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  .stat-label {
    font-size: 0.75rem !important;
    font-weight: 600 !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
}

/* –ö–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
.progress-card-link {
  display: block;
  transition: all 0.2s ease;
}

.progress-card-link:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12) !important;
}

.progress-card-link:active {
  transform: scale(0.98);
}

body.mobile-view .progress-card-link:hover {
  transform: none;
}

body.mobile-view .progress-card-link:active {
  transform: scale(0.98);
}

/* ============================================
   –ú–û–ë–ò–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø - –°–¢–ê–†–¢–û–í–´–ô –≠–ö–†–ê–ù –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
   ============================================ */

/* –ú–æ–±–∏–ª—å–Ω—ã–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–∞–Ω–Ω–µ—Ä */
body.mobile-view .mobile-welcome-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 24px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
  position: relative;
  overflow: hidden;
}

body.mobile-view .mobile-welcome-banner::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -20%;
  width: 200px;
  height: 200px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  pointer-events: none;
}

body.mobile-view .mobile-welcome-content {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1.25rem;
  position: relative;
  z-index: 1;
}

body.mobile-view .mobile-welcome-avatar {
  flex-shrink: 0;
}

body.mobile-view .mobile-welcome-avatar img {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid rgba(255, 255, 255, 0.3);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

body.mobile-view .mobile-avatar-placeholder {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  font-weight: bold;
  border: 3px solid rgba(255, 255, 255, 0.3);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

body.mobile-view .mobile-welcome-text {
  flex: 1;
  min-width: 0;
}

body.mobile-view .mobile-welcome-title {
  font-size: 1.5rem;
  font-weight: 800;
  color: white;
  margin: 0 0 0.25rem 0;
  line-height: 1.2;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

body.mobile-view .mobile-welcome-subtitle {
  font-size: 0.9rem;
  color: rgba(255, 255, 255, 0.9);
  margin: 0;
  font-weight: 500;
}

body.mobile-view .mobile-welcome-stats {
  display: flex;
  gap: 1rem;
  position: relative;
  z-index: 1;
}

body.mobile-view .mobile-stat-mini {
  flex: 1;
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 0.75rem;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

body.mobile-view .mobile-stat-mini-value {
  font-size: 1.5rem;
  font-weight: 800;
  color: white;
  line-height: 1;
  margin-bottom: 0.25rem;
}

body.mobile-view .mobile-stat-mini-label {
  font-size: 0.75rem;
  color: rgba(255, 255, 255, 0.9);
  font-weight: 600;
}

/* –ú–æ–±–∏–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
body.mobile-view .stats-grid {
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
}

body.mobile-view .stat-card {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 1.25rem;
  border: 1px solid rgba(0, 0, 0, 0.05);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
}

body.mobile-view .stat-card:active {
  transform: scale(0.96);
}

body.mobile-view .stat-icon {
  width: 56px;
  height: 56px;
  border-radius: 16px;
  font-size: 1.75rem;
}

body.mobile-view .stat-value {
  font-size: 1.75rem;
  font-weight: 900;
  color: #1f2937;
}

body.mobile-view .stat-label {
  font-size: 0.8rem;
  font-weight: 600;
  color: #6b7280;
  margin-top: 0.25rem;
}

/* –ú–æ–±–∏–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è */
body.mobile-view .mobile-categories-section {
  margin-bottom: 1.5rem;
}

body.mobile-view .mobile-section-title {
  font-size: 1.5rem;
  font-weight: 800;
  color: #1f2937;
  margin: 0 0 1.25rem 0;
  padding: 0 0.5rem;
}

body.mobile-view.dark-theme .mobile-section-title {
  color: #f1f5f9;
}

body.mobile-view .mobile-categories-grid {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

body.mobile-view .mobile-category-card {
  display: flex;
  align-items: center;
  gap: 1rem;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  padding: 1.25rem;
  text-decoration: none;
  color: inherit;
  border: 1px solid rgba(0, 0, 0, 0.05);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

body.mobile-view .mobile-category-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
  opacity: 0;
  transition: opacity 0.3s ease;
}

body.mobile-view .mobile-category-card:active {
  transform: scale(0.98);
}

body.mobile-view .mobile-category-card:active::before {
  opacity: 1;
}

body.mobile-view .mobile-category-icon {
  width: 64px;
  height: 64px;
  border-radius: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

body.mobile-view .mobile-category-icon i {
  font-size: 1.75rem;
  color: white;
}

body.mobile-view .mobile-category-content {
  flex: 1;
  min-width: 0;
}

body.mobile-view .mobile-category-title {
  font-size: 1.1rem;
  font-weight: 800;
  color: #1f2937;
  margin: 0 0 0.5rem 0;
  line-height: 1.2;
}

body.mobile-view.dark-theme .mobile-category-title {
  color: #f1f5f9;
}

body.mobile-view .mobile-category-description {
  font-size: 0.85rem;
  color: #6b7280;
  margin: 0 0 0.75rem 0;
  line-height: 1.4;
}

body.mobile-view.dark-theme .mobile-category-description {
  color: #9ca3af;
}

body.mobile-view .mobile-category-progress {
  display: flex;
  align-items: center;
  gap: 0.75rem;
}

body.mobile-view .mobile-category-progress-bar {
  flex: 1;
  height: 8px;
  background: rgba(0, 0, 0, 0.05);
  border-radius: 4px;
  overflow: hidden;
}

body.mobile-view.dark-theme .mobile-category-progress-bar {
  background: rgba(255, 255, 255, 0.1);
}

body.mobile-view .mobile-category-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
  border-radius: 4px;
  transition: width 0.3s ease;
}

body.mobile-view .mobile-category-progress-text {
  font-size: 0.85rem;
  font-weight: 700;
  color: #667eea;
  min-width: 40px;
  text-align: right;
}

body.mobile-view.dark-theme .mobile-category-progress-text {
  color: #a5b4fc;
}

body.mobile-view .mobile-category-arrow {
  flex-shrink: 0;
  color: #9ca3af;
  font-size: 1.1rem;
}

body.mobile-view.dark-theme .mobile-category-arrow {
  color: #64748b;
}

/* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
body.mobile-view.dark-theme .mobile-welcome-banner {
  background: linear-gradient(135deg, #475569 0%, #334155 100%);
}

body.mobile-view.dark-theme .stat-card,
body.mobile-view.dark-theme .mobile-category-card {
  background: rgba(30, 41, 59, 0.95);
  border-color: rgba(255, 255, 255, 0.1);
}

body.mobile-view.dark-theme .stat-value {
  color: #f1f5f9;
}

body.mobile-view.dark-theme .stat-label {
  color: #94a3b8;
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
body.mobile-view .progress-section {
  margin-bottom: 1.5rem;
}

body.mobile-view .progress-section .card {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  border: 1px solid rgba(0, 0, 0, 0.05);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
}

body.mobile-view.dark-theme .progress-section .card {
  background: rgba(30, 41, 59, 0.95);
  border-color: rgba(255, 255, 255, 0.1);
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
body.mobile-view .recent-achievements {
  margin-bottom: 1.5rem;
}

body.mobile-view .mobile-section-title {
  font-size: 1.25rem;
  margin-bottom: 1rem;
}

body.mobile-view .achievement-mini {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.05);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

body.mobile-view.dark-theme .achievement-mini {
  background: rgba(30, 41, 59, 0.95);
  border-color: rgba(255, 255, 255, 0.1);
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –±–ª–æ–∫–∞ "–û –ø—Ä–æ–µ–∫—Ç–µ" –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ */
body.mobile-view .about-section {
  margin-bottom: 1.5rem;
}

body.mobile-view .about-section .card {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  border: 1px solid rgba(0, 0, 0, 0.05);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
}

body.mobile-view.dark-theme .about-section .card {
  background: rgba(30, 41, 59, 0.95);
  border-color: rgba(255, 255, 255, 0.1);
}
</style>

{% endblock %}

{% block extra_js %}
{% load static %}
<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç—É—Ç–æ—Ä–∏–∞–ª–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
document.addEventListener('DOMContentLoaded', function() {
    const firstVisitTrigger = document.getElementById('first-visit-trigger');
    
    if (firstVisitTrigger) {
        const tutorialCompleted = localStorage.getItem('finquest_tutorial_completed');
        
        if (!tutorialCompleted && typeof FinQuestTutorial !== 'undefined') {
            window.tutorialInstance = new FinQuestTutorial();
            tutorialInstance.start();
        }
    }
    
    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∞–Ω–∏–º–∞—Ü–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    setTimeout(() => {
        document.querySelectorAll('.slide-in-up').forEach((el, index) => {
            el.style.animationDelay = `${index * 0.1}s`;
        });
    }, 100);
});
</script>
{% endblock %}
